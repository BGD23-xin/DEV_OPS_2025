# S3

这个存储数据格式是Object存储，存储数据时，会自动创建一个bucket，bucket名称是唯一的，bucket名称不能重复。

## 创建

`aws cli`[https://docs.aws.amazon.com/cli/latest/reference/s3api/create-bucket.html]

```bash
# 注意 必须有LocationConstraint，不然s3的区域还是 us-east-1
aws s3api create-bucket \
    --bucket bucket_name \
    --region region \
    --create-bucket-configuration LocationConstraint=region
```

`aws CFN`[https://docs.aws.amazon.com/AWSCloudFormation/latest/TemplateReference/aws-resource-s3-bucket.html]

```yaml
# 这个不需要特意配置region，最后的s3的所在区域是根据 aws stack 的所在位置
Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: my-bucket
      
```

`python` 创建

```python
import boto3
# 注意 必须有LocationConstraint
region = 'cn-northwest-1'
profile = 'xin_xu_test'
service = 's3'

session = boto3.Session(profile_name=profile)
s3 = session.client(service, region_name=region)

bucket_name = 'my-bucket'
s3.create_bucket(
    Bucket=bucket_name,
    CreateBucketConfiguration={"LocationConstraint": region}
)
```


`terraform` 创建

region由 provider控制
```terraform

#配置登陆信息
provider "aws" {
  region  = var.region          # e.g. "cn-northwest-1"
  profile = var.profile         # e.g. "xin_xu_test"
}

resource "aws_s3_bucket" "bucket_1" {
  bucket = var.bucket_name

  tags = {
    Name        = var.bucket_name
    Environment = "dev"
  }
}
```